I have conducted a comprehensive analysis of your codebase and identified the root causes of the persistent crashes. The primary issues stem from performing heavy file I/O and image processing operations on the main thread, lack of memory management for large bitmaps, and legacy file access methods that are incompatible with modern Android versions.

Here is the detailed plan to resolve these issues and stabilize the application:

## Phase 1: Dependency & Infrastructure Updates
1.  **Integrate Image Loading Library**: Add **Glide** to `app/build.gradle`. Glide handles async loading, memory caching, and bitmap recycling automatically, resolving the OOM crashes in `MediaGalleryActivity`.
2.  **Add Memory Leak Detection**: Add **LeakCanary** (debugImplementation) to monitor and catch memory leaks during development.
3.  **Standardize Logging**: Create a `SafeLog` utility to wrap Android logging, ensuring we can capture stack traces without crashing production builds.

## Phase 2: Critical Crash Resolution (Threading & I/O)
1.  **Fix `MediaGalleryActivity` ANRs**:
    *   Refactor `loadMedia()` to run on a background thread using **Kotlin Coroutines** (`Dispatchers.IO`).
    *   Move `scanDirectory()` off the main thread to prevent UI freezes.
    *   Update the UI (RecyclerView adapter) only when the data is ready using `withContext(Dispatchers.Main)`.
2.  **Fix `VideoEditorActivity` Blockers**:
    *   Move the video file copying logic in `loadVideo()` to a background coroutine.
    *   Show a loading indicator while the video is being prepared for the editor.

## Phase 3: Image Pipeline & Memory Safety
1.  **Refactor `MediaAdapter`**:
    *   Replace the manual `BitmapFactory.decodeFile()` in `onBindViewHolder` with `Glide.with(context).load(path)`.
    *   This eliminates the main-thread decoding crash and scrolling stutter.
2.  **Harden `PhotoEditorActivity`**:
    *   Wrap `BitmapFactory.decodeStream` in a `try-catch` block that specifically handles `OutOfMemoryError`.
    *   Implement input stream validation to handle "corrupted images" gracefully.
    *   Add a check for maximum texture size to prevent rendering crashes on lower-end devices.

## Phase 4: Compatibility & Validation
1.  **Modernize File Access**: Update `MediaGalleryActivity` to prefer `MediaStore` queries over raw `File` scanning where possible, improving compatibility with Android 10+ Scoped Storage.
2.  **Unit Testing**:
    *   Create `ImageUtilsTest` to verify file extension validation (supporting .webp, .heic).
    *   Create `SafeFileTest` to verify error handling when files are missing or unreadable.

## Phase 5: Verification
1.  **Crash Test**: Simulate a corrupted image load and verify the app shows a "Load Failed" toast instead of crashing.
2.  **Memory Test**: Scroll rapidly through the gallery to verify memory usage remains stable (checked via Profiler).

I will begin by updating the dependencies and then proceed to refactor `MediaGalleryActivity`.
